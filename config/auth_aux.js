const _0xa2a0e6=_0x2fc9;function _0x2fc9(_0x10e8a1,_0x397e26){const _0x27ec6d=_0x27ec();return _0x2fc9=function(_0x2fc911,_0x1afba1){_0x2fc911=_0x2fc911-0x64;let _0x4cedd1=_0x27ec6d[_0x2fc911];return _0x4cedd1;},_0x2fc9(_0x10e8a1,_0x397e26);}function _0x27ec(){const _0x4b6375=['MgDPO','259755AljKUv','xWMRI','Only\x20string\x20arguments\x20are\x20allowed','allow','VgAPH','TypeError:\x20','get','527584byBVnM','.role','slice','Access\x20denied','function','eAcZG','string','split','action','resource','includes','Unauthorized\x20access','isArray','172161tkUmgF','DefinitionError:\x20Unrecognised\x20glob\x20\x22','bVeqi','subRoutes','6212381aCEZLY','FqSPZ','session','replace','TypeError:\x20action\x20should\x20be\x20either\x20\x22deny\x22\x20or\x20\x22allow\x22','zVrzg','match','TypeError:\x20Expected\x20Array\x20but\x20got\x20','6XRuieO','forEach','xWWyF','aBnOZ','object','role','\x20should\x20be\x20a\x20array\x20or\x20string','448CdFHzs','decoded','\x22\x20,\x20use\x20\x22*\x22\x20instead','iHKhd','EyUgi','TebOR','uCvsM','endsWith','Methods','URntJ','set','length','startsWith','1092252cTdWfV','group','cRlTT','methods','decoded.role','json','8682910FBhxKU','deny','session.role','1350586ZgcxvF','permissions','5hKmnNN'];_0x27ec=function(){return _0x4b6375;};return _0x27ec();}(function(_0x562256,_0xbe96a9){const _0x3f8799=_0x2fc9,_0x5efd5c=_0x562256();while(!![]){try{const _0x1e094a=-parseInt(_0x3f8799(0x93))/0x1+parseInt(_0x3f8799(0x9c))/0x2+parseInt(_0x3f8799(0xa0))/0x3+parseInt(_0x3f8799(0x66))/0x4*(-parseInt(_0x3f8799(0x9e))/0x5)+parseInt(_0x3f8799(0x7f))/0x6*(-parseInt(_0x3f8799(0x77))/0x7)+-parseInt(_0x3f8799(0x86))/0x8*(-parseInt(_0x3f8799(0x73))/0x9)+parseInt(_0x3f8799(0x99))/0xa;if(_0x1e094a===_0xbe96a9)break;else _0x5efd5c['push'](_0x5efd5c['shift']());}catch(_0x90f337){_0x5efd5c['push'](_0x5efd5c['shift']());}}}(_0x27ec,0x8ffc2));import _0x2d7d8b,{equal}from'assert';import _0x8a7dd2 from'object-path';const {withInheritedProps:objectPath}=_0x8a7dd2,urlToArray=_0xa85929=>{const _0x1f8d9d=_0x2fc9;if(typeof _0xa85929!==_0x1f8d9d(0x6c)){if(_0x1f8d9d(0x7c)!=='EGctp')throw new Error(_0x1f8d9d(0xa2));else return _0x4bf58a[_0x301ada[_0x1f8d9d(0x91)]]=='*';}return _0xa85929[_0x1f8d9d(0x7a)](/^\/+|\/+$/gm,'')[_0x1f8d9d(0x6d)]('/');},stripQueryStrings=_0x229f6e=>_0x229f6e[_0xa2a0e6(0x6d)](/[?#]/)[0x0],deny=(_0x5f1caf,_0xc1f4e1)=>{const _0xdfdb0a=_0xa2a0e6;let _0x44dff3=_0x5f1caf?_0x5f1caf:_0xdfdb0a(0x71);if(_0xc1f4e1&&typeof _0xc1f4e1==='object'){if(_0xdfdb0a(0x81)!=='jccZe')return _0xc1f4e1;else{let _0xb84604=_0x28fbfe?_0x3ee9be:_0xdfdb0a(0x71);if(_0xfafc77&&typeof _0x405d19===_0xdfdb0a(0x83))return _0x4c5c97;return{'status':_0xdfdb0a(0x69),'success':![],'message':_0xb84604};}}return{'status':_0xdfdb0a(0x69),'success':![],'message':_0x44dff3};},assertIsGlobOrArray=(_0x4ee7a1,_0x5aae06)=>{const _0x49e63d=_0xa2a0e6;if(typeof _0x4ee7a1!==_0x49e63d(0x6c)&&!Array[_0x49e63d(0x72)](_0x4ee7a1)){if(_0x49e63d(0xa1)===_0x49e63d(0x8a))throw new _0x8a26d0('Only\x20string\x20arguments\x20are\x20allowed');else throw new Error('TypeError:\x20'+_0x5aae06+_0x49e63d(0x85));}if(typeof _0x4ee7a1===_0x49e63d(0x6c)&&_0x4ee7a1!=='*')throw new Error(_0x49e63d(0x74)+_0x4ee7a1+_0x49e63d(0x88));},readConfigFile=_0x48c1df=>{return _0x48c1df;},mapPolicyToGroup=_0x17edc7=>{const _0x6798d7=_0xa2a0e6;if(!_0x17edc7){if(_0x6798d7(0x75)==='tXbyD'){if(typeof _0x79ec41!==_0x6798d7(0x6c)&&!_0x52da1e[_0x6798d7(0x72)](_0x3f4c30))throw new _0x4b4835(_0x6798d7(0x64)+_0x21707e+'\x20should\x20be\x20a\x20array\x20or\x20string');if(typeof _0x1f1867===_0x6798d7(0x6c)&&_0x3ba3bb!=='*')throw new _0x1c7d68(_0x6798d7(0x74)+_0x55a6b2+_0x6798d7(0x88));}else return;}const _0x2b2243=new Map();return _0x17edc7[_0x6798d7(0x80)](_0x3f0a02=>{const _0x2b584a=_0x6798d7;equal(typeof _0x3f0a02[_0x2b584a(0x94)],'string'),equal(Array[_0x2b584a(0x72)](_0x3f0a02[_0x2b584a(0x9d)]),!![]),_0x3f0a02[_0x2b584a(0x9d)]['forEach'](_0x5aa4c6=>{const _0xffcd50=_0x2b584a;_0x2d7d8b(typeof _0x5aa4c6[_0xffcd50(0x6f)],_0xffcd50(0x6c)),assertIsGlobOrArray(_0x5aa4c6['methods'],_0xffcd50(0x8e));if(_0x5aa4c6[_0xffcd50(0x6e)]!==_0xffcd50(0xa3)&&_0x5aa4c6[_0xffcd50(0x6e)]!==_0xffcd50(0x9a)){if(_0xffcd50(0x6b)===_0xffcd50(0x6b))throw new Error('TypeError:\x20action\x20should\x20be\x20either\x20\x22deny\x22\x20or\x20\x22allow\x22');else return _0x39a511;}}),_0x2b2243[_0x2b584a(0x90)](_0x3f0a02[_0x2b584a(0x94)],_0x3f0a02['permissions']);}),_0x2b2243;},validatePolicies=_0x175cd6=>{const _0x13e0ae=_0xa2a0e6;if(!Array[_0x13e0ae(0x72)](_0x175cd6))throw new Error(_0x13e0ae(0x7e)+typeof _0x175cd6);return mapPolicyToGroup(_0x175cd6);},createRegexFromResource=_0x3eccea=>{const _0x1b9ee4=_0xa2a0e6;if(_0x3eccea[_0x1b9ee4(0x92)](':')||_0x3eccea==='*')return'.*';return'^'+_0x3eccea+'$';},matchUrlToResource=(_0x12ee9f,_0x3e8374)=>{const _0x7cf3f0=_0xa2a0e6;if(_0x3e8374==='*')return!![];const _0x276daa=urlToArray(_0x12ee9f),_0x12d9ba=urlToArray(_0x3e8374);for(let _0xf257d8=0x0;_0xf257d8<_0x276daa[_0x7cf3f0(0x91)];_0xf257d8++){if(_0xf257d8>=_0x12d9ba[_0x7cf3f0(0x91)])return![];if(_0x12d9ba[_0xf257d8]==='*')return!![];if(!_0x276daa[_0xf257d8][_0x7cf3f0(0x7d)](createRegexFromResource(_0x12d9ba[_0xf257d8])))return![];}if(_0x12d9ba['length']>_0x276daa[_0x7cf3f0(0x91)])return _0x7cf3f0(0xa4)!==_0x7cf3f0(0x8f)?_0x12d9ba[_0x276daa[_0x7cf3f0(0x91)]]=='*':_0x418dca[_0x7cf3f0(0x65)](_0x29edcb,_0x7cf3f0(0x97));return!![];},getPrefix=_0x86f886=>_0x86f886[_0xa2a0e6(0x68)](0x0,_0x86f886['length']-0x2),findPermissionForRoute=(_0x1b7f0e,_0x135b24,_0x4fd0ea='',_0x321c6f)=>{const _0x1813ad=_0xa2a0e6;_0x1b7f0e=stripQueryStrings(_0x1b7f0e);for(let _0x1a0e59 of _0x321c6f){let _0x348c54=_0x1a0e59[_0x1813ad(0x6f)];if(_0x4fd0ea){if(_0x1813ad(0x95)===_0x1813ad(0x9f)){const _0x3cbe8b=_0x12988e[_0x1813ad(0x8d)]('/*')?_0x1c2ebf(_0x290632):_0x3fb797;let _0x48a774=_0x2770ce(_0x3343ae,_0x5af829,_0x3cbe8b,_0x44182a['subRoutes']);if(_0x48a774)return _0x48a774;}else _0x348c54=(_0x4fd0ea+'/'+_0x348c54)[_0x1813ad(0x7a)](/\/+/g,'/');}if(_0x1a0e59[_0x1813ad(0x76)]&&_0x1a0e59[_0x1813ad(0x6f)]!=='*'){const _0x46bbd3=_0x348c54[_0x1813ad(0x8d)]('/*')?getPrefix(_0x348c54):_0x348c54;let _0x34ebad=findPermissionForRoute(_0x1b7f0e,_0x135b24,_0x46bbd3,_0x1a0e59[_0x1813ad(0x76)]);if(_0x34ebad)return _0x34ebad;}if(matchUrlToResource(_0x1b7f0e,_0x348c54))return _0x1a0e59;}},isAllowed=(_0x2e83ed,_0x21b05c)=>{const _0x374a04=_0xa2a0e6,_0x37b7c3=_0x21b05c['methods']==='*'||_0x21b05c['methods'][_0x374a04(0x70)](_0x2e83ed);switch(_0x37b7c3){case!![]:return _0x21b05c[_0x374a04(0x6e)]===_0x374a04(0xa3)?!![]:![];default:return _0x21b05c[_0x374a04(0x6e)]===_0x374a04(0xa3)?![]:!![];}},checkIfHasAccess=(_0x3355ae,_0x11df8c,_0x4a029d,_0x57011a,_0x2bdec8,_0xf0828e,_0xec0709)=>{const _0x351617=_0xa2a0e6;if(isAllowed(_0x3355ae,_0x57011a))return'qRfiN'==='qRfiN'?_0x4a029d():_0x186c38();if(typeof _0xec0709===_0x351617(0x6a))return _0x351617(0x8b)===_0x351617(0x8c)?_0x4079aa['get'](_0x549a33,_0x1b3b04):_0xec0709(_0x11df8c);return _0x11df8c['status'](0x193)[_0x351617(0x98)](deny(_0x2bdec8,_0xf0828e));},findRoleFromRequest=(_0x4e6caf,_0x44b75e,_0x406bc0,_0x7f8661)=>{const _0x503451=_0xa2a0e6;if(_0x44b75e&&objectPath[_0x503451(0x65)](_0x4e6caf,_0x44b75e))return objectPath[_0x503451(0x65)](_0x4e6caf,_0x44b75e);if(_0x7f8661&&objectPath[_0x503451(0x65)](_0x4e6caf,_0x7f8661+_0x503451(0x67))){if(_0x503451(0x78)===_0x503451(0x78))return objectPath['get'](_0x4e6caf,_0x7f8661+_0x503451(0x67));else{_0x1770d4(typeof _0x599903[_0x503451(0x6f)],_0x503451(0x6c)),_0x4a4394(_0x5da0b0[_0x503451(0x96)],_0x503451(0x8e));if(_0x4d1995['action']!==_0x503451(0xa3)&&_0x18286d[_0x503451(0x6e)]!==_0x503451(0x9a))throw new _0x3e34b4(_0x503451(0x7b));}}if(_0x4e6caf[_0x503451(0x87)]&&_0x4e6caf[_0x503451(0x87)][_0x503451(0x84)]){if(_0x503451(0x82)!=='qWiiT')return objectPath[_0x503451(0x65)](_0x4e6caf,'decoded.role');else{if(_0x1aa97d[_0x503451(0x92)](':')||_0x49b39c==='*')return'.*';return'^'+_0x4fe692+'$';}}if(_0x4e6caf[_0x503451(0x79)]&&_0x4e6caf[_0x503451(0x79)][_0x503451(0x84)]){if('KQFHU'!==_0x503451(0x89))return objectPath[_0x503451(0x65)](_0x4e6caf,_0x503451(0x9b));else _0x3e5254(typeof _0x585cbc['group'],_0x503451(0x6c)),_0x5e0b10(_0x5ad645[_0x503451(0x72)](_0x1b2584[_0x503451(0x9d)]),!![]),_0x4c9036['permissions'][_0x503451(0x80)](_0x47268c=>{const _0x319564=_0x503451;_0x5518b9(typeof _0x47268c[_0x319564(0x6f)],'string'),_0x5efa2c(_0x47268c[_0x319564(0x96)],'Methods');if(_0x47268c['action']!==_0x319564(0xa3)&&_0x47268c[_0x319564(0x6e)]!==_0x319564(0x9a))throw new _0x37b6af(_0x319564(0x7b));}),_0x22351e[_0x503451(0x90)](_0x743064['group'],_0x233df0['permissions']);}return _0x406bc0;};export{urlToArray,readConfigFile,mapPolicyToGroup,findRoleFromRequest,findPermissionForRoute,checkIfHasAccess,isAllowed,validatePolicies,matchUrlToResource,assertIsGlobOrArray,deny};